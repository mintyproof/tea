#include "gfx/colour.h"

#include <algorithm>

namespace tea {

ColourRGB::ColourRGB(double r, double g, double b, double a) {
    this->r = std::clamp(r, 0.0, 1.0);
    this->g = std::clamp(g, 0.0, 1.0);
    this->b = std::clamp(b, 0.0, 1.0);
    this->a = std::clamp(a, 0.0, 1.0);
}

void ColourRGB::set(double r, double g, double b, double a) {
    this->r = std::clamp(r, 0.0, 1.0);
    this->g = std::clamp(g, 0.0, 1.0);
    this->b = std::clamp(b, 0.0, 1.0);
    this->a = std::clamp(a, 0.0, 1.0);
}

double ColourRGB::get_r() const {
    return r;
}

double ColourRGB::get_g() const {
    return g;
}

double ColourRGB::get_b() const {
    return b;
}

double ColourRGB::get_a() const {
    return a;
}

uint32_t ColourRGB::get_rgba_bytes() const {
    auto r_byte = static_cast<uint8_t>(r * 255.0);
    auto g_byte = static_cast<uint8_t>(r * 255.0);
    auto b_byte = static_cast<uint8_t>(r * 255.0);
    auto a_byte = static_cast<uint8_t>(r * 255.0);

    return r_byte << 24 | g_byte << 16 | b_byte << 8 | a_byte;
}

ColourRGB ColourRGB::get_inverted() const {
    return { 1.0 - r, 1.0 - g, 1.0 - b, a };
}

ColourRGB ColourRGB::get_greyscale() const {
    // TODO: this is naive implementation, choose better algorithm
    double average = (r + g + b) / 3.0;
    return { average, average, average, a };
}

ColourRGB ColourRGB::from_bytes(uint8_t r, uint8_t g, uint8_t b, uint8_t a) {
    return { static_cast<double>(r) / 255.0,
            static_cast<double>(g) / 255.0,
            static_cast<double>(b) / 255.0,
            static_cast<double>(a) / 255.0 };
}

#define GENERATE_BUILTIN_COLOUR(name, r, g, b) const auto ColourRGB::name = ColourRGB::from_bytes(r, g, b);

GENERATE_BUILTIN_COLOUR(ALICEBLUE, 240, 248, 255)
GENERATE_BUILTIN_COLOUR(ANTIQUEWHITE, 250, 235, 215)
GENERATE_BUILTIN_COLOUR(AQUA, 0, 255, 255)
GENERATE_BUILTIN_COLOUR(AQUAMARINE, 127, 255, 212)
GENERATE_BUILTIN_COLOUR(AZURE, 240, 255, 255)
GENERATE_BUILTIN_COLOUR(BEIGE, 245, 245, 220)
GENERATE_BUILTIN_COLOUR(BISQUE, 255, 228, 196)
GENERATE_BUILTIN_COLOUR(BLACK, 0, 0, 0)
GENERATE_BUILTIN_COLOUR(BLANCHEDALMOND, 255, 235, 205)
GENERATE_BUILTIN_COLOUR(BLUE, 0, 0, 255)
GENERATE_BUILTIN_COLOUR(BLUEVIOLET, 138, 43, 226)
GENERATE_BUILTIN_COLOUR(BROWN, 165, 42, 42)
GENERATE_BUILTIN_COLOUR(BURLYWOOD, 222, 184, 135)
GENERATE_BUILTIN_COLOUR(CADETBLUE, 95, 158, 160)
GENERATE_BUILTIN_COLOUR(CHARTREUSE, 127, 255, 0)
GENERATE_BUILTIN_COLOUR(CHOCOLATE, 210, 105, 30)
GENERATE_BUILTIN_COLOUR(CORAL, 255, 127, 80)
GENERATE_BUILTIN_COLOUR(CORNFLOWERBLUE, 100, 149, 237)
GENERATE_BUILTIN_COLOUR(CORNSILK, 255, 248, 220)
GENERATE_BUILTIN_COLOUR(CRIMSON, 220, 20, 60)
GENERATE_BUILTIN_COLOUR(CYAN, 0, 255, 255)
GENERATE_BUILTIN_COLOUR(DARKBLUE, 0, 0, 139)
GENERATE_BUILTIN_COLOUR(DARKCYAN, 0, 139, 139)
GENERATE_BUILTIN_COLOUR(DARKGOLDENROD, 184, 134, 11)
GENERATE_BUILTIN_COLOUR(DARKGRAY, 169, 169, 169)
GENERATE_BUILTIN_COLOUR(DARKGREEN, 0, 100, 0)
GENERATE_BUILTIN_COLOUR(DARKGREY, 169, 169, 169)
GENERATE_BUILTIN_COLOUR(DARKKHAKI, 189, 183, 107)
GENERATE_BUILTIN_COLOUR(DARKMAGENTA, 139, 0, 139)
GENERATE_BUILTIN_COLOUR(DARKOLIVEGREEN, 85, 107, 47)
GENERATE_BUILTIN_COLOUR(DARKORANGE, 255, 140, 0)
GENERATE_BUILTIN_COLOUR(DARKORCHID, 153, 50, 204)
GENERATE_BUILTIN_COLOUR(DARKRED, 139, 0, 0)
GENERATE_BUILTIN_COLOUR(DARKSALMON, 233, 150, 122)
GENERATE_BUILTIN_COLOUR(DARKSEAGREEN, 143, 188, 143)
GENERATE_BUILTIN_COLOUR(DARKSLATEBLUE, 72, 61, 139)
GENERATE_BUILTIN_COLOUR(DARKSLATEGRAY, 47, 79, 79)
GENERATE_BUILTIN_COLOUR(DARKSLATEGREY, 47, 79, 79)
GENERATE_BUILTIN_COLOUR(DARKTURQUOISE, 0, 206, 209)
GENERATE_BUILTIN_COLOUR(DARKVIOLET, 148, 0, 211)
GENERATE_BUILTIN_COLOUR(DEEPPINK, 255, 20, 147)
GENERATE_BUILTIN_COLOUR(DEEPSKYBLUE, 0, 191, 255)
GENERATE_BUILTIN_COLOUR(DIMGRAY, 105, 105, 105)
GENERATE_BUILTIN_COLOUR(DIMGREY, 105, 105, 105)
GENERATE_BUILTIN_COLOUR(DODGERBLUE, 30, 144, 255)
GENERATE_BUILTIN_COLOUR(FIREBRICK, 178, 34, 34)
GENERATE_BUILTIN_COLOUR(FLORALWHITE, 255, 250, 240)
GENERATE_BUILTIN_COLOUR(FORESTGREEN, 34, 139, 34)
GENERATE_BUILTIN_COLOUR(FUCHSIA, 255, 0, 255)
GENERATE_BUILTIN_COLOUR(GAINSBORO, 220, 220, 220)
GENERATE_BUILTIN_COLOUR(GHOSTWHITE, 248, 248, 255)
GENERATE_BUILTIN_COLOUR(GOLD, 255, 215, 0)
GENERATE_BUILTIN_COLOUR(GOLDENROD, 218, 165, 32)
GENERATE_BUILTIN_COLOUR(GRAY, 128, 128, 128)
GENERATE_BUILTIN_COLOUR(GREEN, 0, 128, 0)
GENERATE_BUILTIN_COLOUR(GREENYELLOW, 173, 255, 47)
GENERATE_BUILTIN_COLOUR(GREY, 128, 128, 128)
GENERATE_BUILTIN_COLOUR(HONEYDEW, 240, 255, 240)
GENERATE_BUILTIN_COLOUR(HOTPINK, 255, 105, 180)
GENERATE_BUILTIN_COLOUR(INDIANRED, 205, 92, 92)
GENERATE_BUILTIN_COLOUR(INDIGO, 75, 0, 130)
GENERATE_BUILTIN_COLOUR(IVORY, 255, 255, 240)
GENERATE_BUILTIN_COLOUR(KHAKI, 240, 230, 140)
GENERATE_BUILTIN_COLOUR(LAVENDER, 230, 230, 250)
GENERATE_BUILTIN_COLOUR(LAVENDERBLUSH, 255, 240, 245)
GENERATE_BUILTIN_COLOUR(LAWNGREEN, 124, 252, 0)
GENERATE_BUILTIN_COLOUR(LEMONCHIFFON, 255, 250, 205)
GENERATE_BUILTIN_COLOUR(LIGHTBLUE, 173, 216, 230)
GENERATE_BUILTIN_COLOUR(LIGHTCORAL, 240, 128, 128)
GENERATE_BUILTIN_COLOUR(LIGHTCYAN, 224, 255, 255)
GENERATE_BUILTIN_COLOUR(LIGHTGOLDENRODYELLOW, 250, 250, 210)
GENERATE_BUILTIN_COLOUR(LIGHTGRAY, 211, 211, 211)
GENERATE_BUILTIN_COLOUR(LIGHTGREEN, 144, 238, 144)
GENERATE_BUILTIN_COLOUR(LIGHTGREY, 211, 211, 211)
GENERATE_BUILTIN_COLOUR(LIGHTPINK, 255, 182, 193)
GENERATE_BUILTIN_COLOUR(LIGHTSALMON, 255, 160, 122)
GENERATE_BUILTIN_COLOUR(LIGHTSEAGREEN, 32, 178, 170)
GENERATE_BUILTIN_COLOUR(LIGHTSKYBLUE, 135, 206, 250)
GENERATE_BUILTIN_COLOUR(LIGHTSLATEGRAY, 119, 136, 153)
GENERATE_BUILTIN_COLOUR(LIGHTSLATEGREY, 119, 136, 153)
GENERATE_BUILTIN_COLOUR(LIGHTSTEELBLUE, 176, 196, 222)
GENERATE_BUILTIN_COLOUR(LIGHTYELLOW, 255, 255, 224)
GENERATE_BUILTIN_COLOUR(LIME, 0, 255, 0)
GENERATE_BUILTIN_COLOUR(LIMEGREEN, 50, 205, 50)
GENERATE_BUILTIN_COLOUR(LINEN, 250, 240, 230)
GENERATE_BUILTIN_COLOUR(MAGENTA, 255, 0, 255)
GENERATE_BUILTIN_COLOUR(MAROON, 128, 0, 0)
GENERATE_BUILTIN_COLOUR(MEDIUMAQUAMARINE, 102, 205, 170)
GENERATE_BUILTIN_COLOUR(MEDIUMBLUE, 0, 0, 205)
GENERATE_BUILTIN_COLOUR(MEDIUMORCHID, 186, 85, 211)
GENERATE_BUILTIN_COLOUR(MEDIUMPURPLE, 147, 112, 219)
GENERATE_BUILTIN_COLOUR(MEDIUMSEAGREEN, 60, 179, 113)
GENERATE_BUILTIN_COLOUR(MEDIUMSLATEBLUE, 123, 104, 238)
GENERATE_BUILTIN_COLOUR(MEDIUMSPRINGGREEN, 0, 250, 154)
GENERATE_BUILTIN_COLOUR(MEDIUMTURQUOISE, 72, 209, 204)
GENERATE_BUILTIN_COLOUR(MEDIUMVIOLETRED, 199, 21, 133)
GENERATE_BUILTIN_COLOUR(MIDNIGHTBLUE, 25, 25, 112)
GENERATE_BUILTIN_COLOUR(MINTCREAM, 245, 255, 250)
GENERATE_BUILTIN_COLOUR(MISTYROSE, 255, 228, 225)
GENERATE_BUILTIN_COLOUR(MOCCASIN, 255, 228, 181)
GENERATE_BUILTIN_COLOUR(NAVAJOWHITE, 255, 222, 173)
GENERATE_BUILTIN_COLOUR(NAVY, 0, 0, 128)
GENERATE_BUILTIN_COLOUR(OLDLACE, 253, 245, 230)
GENERATE_BUILTIN_COLOUR(OLIVE, 128, 128, 0)
GENERATE_BUILTIN_COLOUR(OLIVEDRAB, 107, 142, 35)
GENERATE_BUILTIN_COLOUR(ORANGE, 255, 165, 0)
GENERATE_BUILTIN_COLOUR(ORANGERED, 255, 69, 0)
GENERATE_BUILTIN_COLOUR(ORCHID, 218, 112, 214)
GENERATE_BUILTIN_COLOUR(PALEGOLDENROD, 238, 232, 170)
GENERATE_BUILTIN_COLOUR(PALEGREEN, 152, 251, 152)
GENERATE_BUILTIN_COLOUR(PALETURQUOISE, 175, 238, 238)
GENERATE_BUILTIN_COLOUR(PALEVIOLETRED, 219, 112, 147)
GENERATE_BUILTIN_COLOUR(PAPAYAWHIP, 255, 239, 213)
GENERATE_BUILTIN_COLOUR(PEACHPUFF, 255, 218, 185)
GENERATE_BUILTIN_COLOUR(PERU, 205, 133, 63)
GENERATE_BUILTIN_COLOUR(PINK, 255, 192, 203)
GENERATE_BUILTIN_COLOUR(PLUM, 221, 160, 221)
GENERATE_BUILTIN_COLOUR(POWDERBLUE, 176, 224, 230)
GENERATE_BUILTIN_COLOUR(PURPLE, 128, 0, 128)
GENERATE_BUILTIN_COLOUR(RED, 255, 0, 0)
GENERATE_BUILTIN_COLOUR(ROSYBROWN, 188, 143, 143)
GENERATE_BUILTIN_COLOUR(ROYALBLUE, 65, 105, 225)
GENERATE_BUILTIN_COLOUR(SADDLEBROWN, 139, 69, 19)
GENERATE_BUILTIN_COLOUR(SALMON, 250, 128, 114)
GENERATE_BUILTIN_COLOUR(SANDYBROWN, 244, 164, 96)
GENERATE_BUILTIN_COLOUR(SEAGREEN, 46, 139, 87)
GENERATE_BUILTIN_COLOUR(SEASHELL, 255, 245, 238)
GENERATE_BUILTIN_COLOUR(SIENNA, 160, 82, 45)
GENERATE_BUILTIN_COLOUR(SILVER, 192, 192, 192)
GENERATE_BUILTIN_COLOUR(SKYBLUE, 135, 206, 235)
GENERATE_BUILTIN_COLOUR(SLATEBLUE, 106, 90, 205)
GENERATE_BUILTIN_COLOUR(SLATEGRAY, 112, 128, 144)
GENERATE_BUILTIN_COLOUR(SLATEGREY, 112, 128, 144)
GENERATE_BUILTIN_COLOUR(SNOW, 255, 250, 250)
GENERATE_BUILTIN_COLOUR(SPRINGGREEN, 0, 255, 127)
GENERATE_BUILTIN_COLOUR(STEELBLUE, 70, 130, 180)
GENERATE_BUILTIN_COLOUR(TAN, 210, 180, 140)
GENERATE_BUILTIN_COLOUR(TEAL, 0, 128, 128)
GENERATE_BUILTIN_COLOUR(THISTLE, 216, 191, 216)
GENERATE_BUILTIN_COLOUR(TOMATO, 255, 99, 71)
GENERATE_BUILTIN_COLOUR(TURQUOISE, 64, 224, 208)
GENERATE_BUILTIN_COLOUR(VIOLET, 238, 130, 238)
GENERATE_BUILTIN_COLOUR(WHEAT, 245, 222, 179)
GENERATE_BUILTIN_COLOUR(WHITE, 255, 255, 255)
GENERATE_BUILTIN_COLOUR(WHITESMOKE, 245, 245, 245)
GENERATE_BUILTIN_COLOUR(YELLOW, 255, 255, 0)
GENERATE_BUILTIN_COLOUR(YELLOWGREEN, 154, 205, 50)

}